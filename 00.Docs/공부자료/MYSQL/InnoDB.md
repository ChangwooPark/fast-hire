# 🏗️ MySQL 스토리지 엔진: InnoDB 이해하기

데이터베이스 테이블을 생성할 때 마지막에 붙는 `ENGINE=InnoDB`는 해당 테이블의 데이터를 물리적으로 어떻게 관리하고, 어떤 기능을 지원할지 결정하는 **'저장 시스템(Storage Engine)'**을 지정하는 옵션입니다.

---

## 1. 스토리지 엔진이란? (Storage Engine)
MySQL 아키텍처에서 쿼리 파싱이나 SQL 분석을 담당하는 상위 계층과 달리, **실제 데이터를 디스크에 쓰고 읽는 물리적인 엔진**을 말합니다. MySQL은 다양한 엔진을 지원하며 필요에 따라 테이블 단위로 교체가 가능합니다.



---

## 2. InnoDB의 핵심 특징 (왜 현대적 표준인가?)

작성하신 채팅 및 구인 서비스 시스템에서 InnoDB를 선택해야 하는 4가지 결정적인 이유입니다.

### ① 트랜잭션 지원 (ACID 준수)
* **정의:** 여러 작업을 하나의 논리적 단위로 묶어 '전부 성공'하거나 '전부 실패(Rollback)'함을 보장합니다.
* **중요성:** 데이터의 일관성을 유지하며, 갑작스러운 오류 시에도 데이터가 깨지는 것을 방지합니다.

### ② 외래 키(Foreign Key) 지원
* **정의:** 테이블 간의 관계(Constraints)를 설정할 수 있습니다.
* **효과:** 부모 데이터(유저)가 삭제될 때 자식 데이터(메시지)를 함께 삭제(`ON DELETE CASCADE`)하는 등의 참조 무결성을 DB 수준에서 강제합니다.

### ③ 행 단위 잠금 (Row-level Locking)
* **정의:** 데이터를 수정할 때 테이블 전체가 아닌, 수정 중인 **특정 행(Row)**만 잠급니다.
* **장점:** 여러 사용자가 동시에 데이터를 읽고 써도 대기 시간이 짧아, 채팅과 같이 동시 접속이 많은 서비스에 필수적입니다.

### ④ 자동 복구 (Crash Recovery)
* **정의:** 시스템이 예기치 않게 종료되었을 때, 로그 파일(Redo Log 등)을 사용하여 마지막으로 커밋된 상태까지 자동으로 복구합니다.

---

## 3. InnoDB vs MyISAM 비교

과거에 많이 쓰였던 MyISAM 엔진과의 차이를 알면 InnoDB의 장점이 더 명확해집니다.

| 특징 | InnoDB (현대적 표준) | MyISAM (레거시) |
| :--- | :--- | :--- |
| **트랜잭션** | **지원** | 미지원 |
| **잠금(Locking)** | **행(Row) 단위** | 테이블(Table) 단위 |
| **참조 무결성(FK)** | **지원** | 미지원 |
| **데이터 안정성** | 매우 높음 | 상대적으로 낮음 |
| **권장 용도** | **서비스 운영(채팅, 금융 등)** | 대량의 단순 조회/로그용 |

---

## 4. 📝 학습 포인트 (Summary)

* **InnoDB**는 MySQL 5.5 버전부터 **기본 스토리지 엔진**입니다.
* **외래 키(Foreign Key)**를 사용하여 테이블 간의 관계를 설계했다면, 반드시 `ENGINE=InnoDB`가 필요합니다. (다른 엔진은 구문은 허용하나 실제 기능이 작동하지 않을 수 있음)
* **채팅 메시지**처럼 쓰기/읽기가 빈번하고 데이터 무결성이 중요한 시스템에는 고민 없이 InnoDB를 선택하는 것이 정석입니다.